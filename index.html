<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة FYO التعليمية | تسجيل الدخول</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', 'Cairo', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .background-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-20px) translateX(10px); }
            50% { transform: translateY(-40px) translateX(20px); }
            75% { transform: translateY(-20px) translateX(10px); }
            100% { transform: translateY(0) translateX(0); }
        }

        .container {
            width: 100%;
            max-width: 450px;
            z-index: 1;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(to right, #ff9a9e, #fad0c4, #fad0c4, #a18cd1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #a1c4fd;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px 35px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .login-card:hover {
            transform: translateY(-5px);
        }

        .login-title {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 30px;
            font-weight: 600;
            color: #fff;
            position: relative;
            padding-bottom: 15px;
        }

        .login-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 50%;
            transform: translateX(50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #e0e0e0;
            font-size: 0.95rem;
        }

        .input-with-icon {
            position: relative;
        }

        .form-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #a18cd1;
            box-shadow: 0 0 0 2px rgba(161, 140, 209, 0.3);
            background: rgba(255, 255, 255, 0.1);
        }

        .input-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #a1c4fd;
            font-size: 1.1rem;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            border: none;
            border-radius: 12px;
            color: #1a1a2e;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            letter-spacing: 1px;
        }

        .login-btn:hover {
            background: linear-gradient(to right, #fad0c4, #ff9a9e);
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
            transform: translateY(-2px);
        }

        .admin-info {
            text-align: center;
            margin-top: 25px;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            padding: 15px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .copyright {
            text-align: center;
            margin-top: 40px;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        /* نمط لوحة المسؤول */
        .admin-panel {
            display: none;
            width: 100%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1;
            position: relative;
            margin: 0 auto;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-header h1 {
            font-size: 1.8rem;
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .admin-nav {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #fff;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-btn.active {
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            color: #1a1a2e;
        }

        .nav-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }

        .admin-section {
            display: none;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .admin-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: #fff;
            border-right: 4px solid #ff9a9e;
            padding-right: 15px;
        }

        .users-table, .files-table, .tests-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .users-table th, .files-table th, .tests-table th {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            text-align: right;
            font-weight: 500;
        }

        .users-table td, .files-table td, .tests-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #fff;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            margin-left: 8px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-danger {
            background: rgba(255, 99, 99, 0.2);
            border-color: rgba(255, 99, 99, 0.3);
        }

        .btn-danger:hover {
            background: rgba(255, 99, 99, 0.3);
        }

        .btn-success {
            background: rgba(99, 255, 136, 0.2);
            border-color: rgba(99, 255, 136, 0.3);
        }

        .btn-success:hover {
            background: rgba(99, 255, 136, 0.3);
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group-half {
            flex: 1;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .welcome-message {
            background: linear-gradient(to right, rgba(255, 154, 158, 0.1), rgba(250, 208, 196, 0.1));
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .welcome-title {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #fff;
        }

        .welcome-text {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        /* تصميم للهواتف */
        @media (max-width: 768px) {
            .admin-panel {
                padding: 20px;
            }
            
            .admin-nav {
                flex-direction: column;
            }
            
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .users-table, .files-table, .tests-table {
                font-size: 0.85rem;
            }
            
            .users-table td, .files-table td, .tests-table td {
                padding: 10px 5px;
            }
        }

        /* تصميم لشاشات كبيرة */
        @media (min-width: 1200px) {
            .container {
                max-width: 500px;
            }
        }
    </style>
</head>
<body>
    <!-- رسوم متحركة في الخلفية -->
    <div class="background-animation" id="backgroundAnimation"></div>
    
    <!-- واجهة تسجيل الدخول -->
    <div class="container" id="loginContainer">
        <div class="header">
            <div class="logo">F Y O</div>
            <div class="subtitle">منصة القدرات التعليمية الفاخرة</div>
        </div>
        
        <div class="login-card">
            <h2 class="login-title">تسجيل الدخول</h2>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">اسم المستخدم</label>
                    <div class="input-with-icon">
                        <input type="text" class="form-input" id="username" placeholder="أدخل اسم المستخدم" required>
                        <div class="input-icon">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">كلمة المرور</label>
                    <div class="input-with-icon">
                        <input type="password" class="form-input" id="password" placeholder="أدخل كلمة المرور" required>
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
                </button>
            </form>
            
            <div class="admin-info">
                <p>بيانات الدخول الافتراضية للمسؤول:</p>
                <p><strong>اسم المستخدم:</strong> admin | <strong>كلمة المرور:</strong> admin</p>
            </div>
        </div>
        
        <div class="copyright">
            © 2023 منصة FYO التعليمية. جميع الحقوق محفوظة.
        </div>
    </div>
    
    <!-- لوحة تحكم المسؤول -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h1><i class="fas fa-crown"></i> لوحة تحكم منصة FYO التعليمية</h1>
            <button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> تسجيل الخروج</button>
        </div>
        
        <!-- رسالة ترحيبية -->
        <div class="welcome-message">
            <h2 class="welcome-title">مرحباً بك في منصة FYO التعليمية</h2>
            <p class="welcome-text">من هنا يمكنك إدارة جميع جوانب المنصة التعليمية، بدءاً من إدارة المستخدمين وحتى رفع الاختبارات والملفات التعليمية للطلاب.</p>
        </div>
        
        <!-- شريط التنقل -->
        <div class="admin-nav">
            <button class="nav-btn active" data-section="users-section"><i class="fas fa-users"></i> إدارة المستخدمين</button>
            <button class="nav-btn" data-section="files-section"><i class="fas fa-file-upload"></i> رفع الملفات</button>
            <button class="nav-btn" data-section="tests-section"><i class="fas fa-file-alt"></i> إدارة الاختبارات</button>
            <button class="nav-btn" data-section="stats-section"><i class="fas fa-chart-line"></i> إحصائيات الطلاب</button>
        </div>
        
        <!-- قسم إدارة المستخدمين -->
        <div class="admin-section active" id="users-section">
            <h2 class="section-title"><i class="fas fa-user-plus"></i> إضافة مستخدم جديد</h2>
            
            <form id="addUserForm">
                <div class="form-row">
                    <div class="form-group-half">
                        <label class="form-label">اسم المستخدم</label>
                        <input type="text" class="form-input" id="newUsername" placeholder="اسم المستخدم الجديد" required>
                    </div>
                    <div class="form-group-half">
                        <label class="form-label">كلمة المرور</label>
                        <input type="password" class="form-input" id="newPassword" placeholder="كلمة المرور للمستخدم" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group-half">
                        <label class="form-label">البريد الإلكتروني</label>
                        <input type="email" class="form-input" id="newEmail" placeholder="البريد الإلكتروني">
                    </div>
                    <div class="form-group-half">
                        <label class="form-label">مدة الاشتراك (أيام)</label>
                        <input type="number" class="form-input" id="subscriptionDays" placeholder="عدد أيام الاشتراك" min="1" value="30" required>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="action-btn btn-success"><i class="fas fa-user-plus"></i> إضافة مستخدم جديد</button>
                    <button type="button" class="action-btn" id="renewAllBtn"><i class="fas fa-sync-alt"></i> تجديد جميع الاشتراكات</button>
                </div>
            </form>
            
            <h2 class="section-title" style="margin-top: 40px;"><i class="fas fa-list"></i> قائمة المستخدمين</h2>
            <table class="users-table">
                <thead>
                    <tr>
                        <th>اسم المستخدم</th>
                        <th>البريد الإلكتروني</th>
                        <th>تاريخ الانضمام</th>
                        <th>انتهاء الاشتراك</th>
                        <th>أيام متبقية</th>
                        <th>ستريك الدخول</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody id="usersTableBody">
                    <!-- سيتم ملئها بواسطة الجافاسكريبت -->
                </tbody>
            </table>
        </div>
        
        <!-- قسم رفع الملفات -->
        <div class="admin-section" id="files-section">
            <h2 class="section-title"><i class="fas fa-cloud-upload-alt"></i> رفع ملفات تعليمية</h2>
            
            <form id="uploadFileForm">
                <div class="form-row">
                    <div class="form-group-half">
                        <label class="form-label">عنوان الملف</label>
                        <input type="text" class="form-input" id="fileTitle" placeholder="عنوان الملف التعليمي" required>
                    </div>
                    <div class="form-group-half">
                        <label class="form-label">نوع الملف</label>
                        <select class="form-input" id="fileType" required>
                            <option value="pdf">PDF</option>
                            <option value="word">Word</option>
                            <option value="video">فيديو</option>
                            <option value="image">صورة</option>
                            <option value="other">أخرى</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">وصف الملف</label>
                    <textarea class="form-input" id="fileDescription" placeholder="وصف مختصر للملف" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">رفع الملف</label>
                    <div class="input-with-icon">
                        <input type="file" class="form-input" id="fileUpload" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">المستخدمون المصرح لهم</label>
                    <div id="usersChecklist">
                        <!-- سيتم ملئها بواسطة الجافاسكريبت -->
                    </div>
                    <button type="button" class="action-btn" id="selectAllUsers" style="margin-top: 10px;"><i class="fas fa-check-square"></i> تحديد الكل</button>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="action-btn btn-success"><i class="fas fa-upload"></i> رفع الملف</button>
                </div>
            </form>
            
            <h2 class="section-title" style="margin-top: 40px;"><i class="fas fa-file-archive"></i> الملفات المرفوعة</h2>
            <table class="files-table">
                <thead>
                    <tr>
                        <th>عنوان الملف</th>
                        <th>النوع</th>
                        <th>تاريخ الرفع</th>
                        <th>عدد المستخدمين</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody id="filesTableBody">
                    <!-- سيتم ملئها بواسطة الجافاسكريبت -->
                </tbody>
            </table>
        </div>
        
        <!-- قسم إدارة الاختبارات -->
        <div class="admin-section" id="tests-section">
            <h2 class="section-title"><i class="fas fa-edit"></i> إنشاء اختبار جديد</h2>
            
            <form id="addTestForm">
                <div class="form-row">
                    <div class="form-group-half">
                        <label class="form-label">عنوان الاختبار</label>
                        <input type="text" class="form-input" id="testTitle" placeholder="عنوان الاختبار" required>
                    </div>
                    <div class="form-group-half">
                        <label class="form-label">مدة الاختبار (دقائق)</label>
                        <input type="number" class="form-input" id="testDuration" placeholder="مدة الاختبار" min="1" value="60" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">وصف الاختبار</label>
                    <textarea class="form-input" id="testDescription" placeholder="وصف مختصر للاختبار" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">طريقة إضافة الأسئلة</label>
                    <div style="display: flex; gap: 20px; margin-top: 10px;">
                        <div>
                            <input type="radio" id="uploadImage" name="questionType" value="image" checked>
                            <label for="uploadImage">رفع صورة للسؤال</label>
                        </div>
                        <div>
                            <input type="radio" id="writeQuestion" name="questionType" value="text">
                            <label for="writeQuestion">كتابة السؤال نصياً</label>
                        </div>
                    </div>
                </div>
                
                <div id="questionImageUpload" class="form-group">
                    <label class="form-label">رفع صورة السؤال</label>
                    <div class="input-with-icon">
                        <input type="file" class="form-input" id="questionImage" accept="image/*">
                    </div>
                </div>
                
                <div id="questionTextInput" class="form-group" style="display: none;">
                    <label class="form-label">نص السؤال</label>
                    <textarea class="form-input" id="questionText" placeholder="اكتب نص السؤال هنا" rows="4"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">الاختيارات</label>
                    <div class="form-row">
                        <div class="form-group-half">
                            <input type="text" class="form-input" id="choiceA" placeholder="الاختيار الأول (أ)" required>
                        </div>
                        <div class="form-group-half">
                            <input type="text" class="form-input" id="choiceB" placeholder="الاختيار الثاني (ب)" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group-half">
                            <input type="text" class="form-input" id="choiceC" placeholder="الاختيار الثالث (ج)" required>
                        </div>
                        <div class="form-group-half">
                            <input type="text" class="form-input" id="choiceD" placeholder="الاختيار الرابع (د)" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">الإجابة الصحيحة</label>
                    <select class="form-input" id="correctAnswer" required>
                        <option value="a">الاختيار الأول (أ)</option>
                        <option value="b">الاختيار الثاني (ب)</option>
                        <option value="c">الاختيار الثالث (ج)</option>
                        <option value="d">الاختيار الرابع (د)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">المستخدمون المصرح لهم بالاختبار</label>
                    <div id="testUsersChecklist">
                        <!-- سيتم ملئها بواسطة الجافاسكريبت -->
                    </div>
                    <button type="button" class="action-btn" id="selectAllTestUsers" style="margin-top: 10px;"><i class="fas fa-check-square"></i> تحديد الكل</button>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="action-btn btn-success"><i class="fas fa-plus-circle"></i> إضافة سؤال للاختبار</button>
                    <button type="button" class="action-btn" id="finishTestBtn"><i class="fas fa-check-double"></i> إنهاء الاختبار</button>
                </div>
            </form>
            
            <h2 class="section-title" style="margin-top: 40px;"><i class="fas fa-clipboard-list"></i> الاختبارات المنشورة</h2>
            <table class="tests-table">
                <thead>
                    <tr>
                        <th>عنوان الاختبار</th>
                        <th>عدد الأسئلة</th>
                        <th>المدة</th>
                        <th>تاريخ الإنشاء</th>
                        <th>عدد المستخدمين</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody id="testsTableBody">
                    <!-- سيتم ملئها بواسطة الجافاسكريبت -->
                </tbody>
            </table>
        </div>
        
        <!-- قسم إحصائيات الطلاب -->
        <div class="admin-section" id="stats-section">
            <h2 class="section-title"><i class="fas fa-chart-bar"></i> إحصائيات الطلاب</h2>
            
            <div class="form-row">
                <div class="form-group-half">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; text-align: center;">
                        <h3 style="color: #ff9a9e; margin-bottom: 10px;">إجمالي المستخدمين</h3>
                        <p style="font-size: 2.5rem; font-weight: bold;" id="totalUsers">5</p>
                    </div>
                </div>
                <div class="form-group-half">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; text-align: center;">
                        <h3 style="color: #a18cd1; margin-bottom: 10px;">الملفات المرفوعة</h3>
                        <p style="font-size: 2.5rem; font-weight: bold;" id="totalFiles">3</p>
                    </div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group-half">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; text-align: center;">
                        <h3 style="color: #fad0c4; margin-bottom: 10px;">الاختبارات المنشورة</h3>
                        <p style="font-size: 2.5rem; font-weight: bold;" id="totalTests">2</p>
                    </div>
                </div>
                <div class="form-group-half">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; text-align: center;">
                        <h3 style="color: #a1c4fd; margin-bottom: 10px;">متوسط ستريك الدخول</h3>
                        <p style="font-size: 2.5rem; font-weight: bold;" id="avgStreak">4.2</p>
                    </div>
                </div>
            </div>
            
            <h2 class="section-title" style="margin-top: 40px;"><i class="fas fa-fire"></i> ترتيب الطلاب حسب ستريك الدخول</h2>
            <table class="users-table">
                <thead>
                    <tr>
                        <th>الترتيب</th>
                        <th>اسم المستخدم</th>
                        <th>ستريك الدخول</th>
                        <th>آخر دخول</th>
                        <th>الحالة</th>
                    </tr>
                </thead>
                <tbody id="streakTableBody">
                    <!-- سيتم ملئها بواسطة الجافاسكريبت -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // إنشاء الرسوم المتحركة في الخلفية
        function createParticles() {
            const container = document.getElementById('backgroundAnimation');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // أحجام وألوان عشوائية
                const size = Math.random() * 10 + 5;
                const colorValue = Math.random() * 60 + 40;
                
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.background = `rgba(${colorValue}, ${colorValue}, ${colorValue + 100}, ${Math.random() * 0.1 + 0.05})`;
                
                // مواقع عشوائية
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // سرعات عشوائية
                const duration = Math.random() * 30 + 20;
                const delay = Math.random() * 5;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${delay}s`;
                
                container.appendChild(particle);
            }
        }
        
        // بيانات التطبيق
        let appData = {
            currentUser: null,
            users: [
                {username: "admin", password: "admin", email: "admin@fyo.com", joinDate: "2023-01-01", subscriptionEnd: "2024-12-31", streak: 7, lastLogin: "2023-06-15", isAdmin: true},
                {username: "طالب1", password: "123456", email: "student1@example.com", joinDate: "2023-05-10", subscriptionEnd: "2023-07-10", streak: 5, lastLogin: "2023-06-14"},
                {username: "طالب2", password: "123456", email: "student2@example.com", joinDate: "2023-05-15", subscriptionEnd: "2023-07-15", streak: 3, lastLogin: "2023-06-13"},
                {username: "طالب3", password: "123456", email: "student3@example.com", joinDate: "2023-05-20", subscriptionEnd: "2023-07-20", streak: 10, lastLogin: "2023-06-15"},
                {username: "طالب4", password: "123456", email: "student4@example.com", joinDate: "2023-05-25", subscriptionEnd: "2023-07-25", streak: 2, lastLogin: "2023-06-12"}
            ],
            files: [
                {id: 1, title: "دليل القدرات الكمي", type: "pdf", description: "دليل شامل للقسم الكمي في اختبار القدرات", uploadDate: "2023-06-01", users: ["طالب1", "طالب2", "طالب3"]},
                {id: 2, title: "فيديو شرح الهندسة", type: "video", description: "شرح مفصل لفقرات الهندسة في القدرات", uploadDate: "2023-06-05", users: ["طالب1", "طالب3"]},
                {id: 3, title: "أسئلة قدرات محلولة", type: "word", description: "مجموعة أسئلة مع الحلول التفصيلية", uploadDate: "2023-06-10", users: ["طالب2", "طالب4"]}
            ],
            tests: [
                {id: 1, title: "اختبار تجريبي 1", description: "اختبار تجريبي شامل لمختلف أقسام القدرات", duration: 60, questions: 20, creationDate: "2023-06-03", users: ["طالب1", "طالب3", "طالب4"]},
                {id: 2, title: "اختبار كمي متقدم", description: "اختبار متقدم للقسم الكمي فقط", duration: 45, questions: 15, creationDate: "2023-06-08", users: ["طالب2", "طالب3"]}
            ],
            currentTestQuestions: []
        };
        
        // حساب الأيام المتبقية للاشتراك
        function calculateRemainingDays(endDate) {
            const today = new Date();
            const end = new Date(endDate);
            const diffTime = end - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }
        
        // تحديث قائمة المستخدمين في الجدول
        function updateUsersTable() {
            const tableBody = document.getElementById('usersTableBody');
            tableBody.innerHTML = '';
            
            appData.users.forEach((user, index) => {
                if (user.username === 'admin') return; // تخطي المسؤول
                
                const remainingDays = calculateRemainingDays(user.subscriptionEnd);
                const statusClass = remainingDays > 7 ? 'btn-success' : (remainingDays > 0 ? '' : 'btn-danger');
                const statusText = remainingDays > 0 ? `${remainingDays} يوم` : 'منتهي';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.email || 'لا يوجد'}</td>
                    <td>${user.joinDate}</td>
                    <td>${user.subscriptionEnd}</td>
                    <td><span class="action-btn ${statusClass}" style="cursor: default;">${statusText}</span></td>
                    <td>${user.streak} يوم</td>
                    <td>
                        <button class="action-btn btn-success renew-btn" data-username="${user.username}"><i class="fas fa-sync-alt"></i> تجديد</button>
                        <button class="action-btn btn-danger delete-btn" data-username="${user.username}"><i class="fas fa-trash-alt"></i> حذف</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // تحديث الإحصائيات
            document.getElementById('totalUsers').textContent = appData.users.filter(u => !u.isAdmin).length;
            document.getElementById('avgStreak').textContent = (appData.users
                .filter(u => !u.isAdmin)
                .reduce((sum, user) => sum + user.streak, 0) / appData.users.filter(u => !u.isAdmin).length).toFixed(1);
        }
        
        // تحديث قائمة الملفات في الجدول
        function updateFilesTable() {
            const tableBody = document.getElementById('filesTableBody');
            tableBody.innerHTML = '';
            
            appData.files.forEach((file, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${file.title}</td>
                    <td>${file.type}</td>
                    <td>${file.uploadDate}</td>
                    <td>${file.users.length} مستخدم</td>
                    <td>
                        <button class="action-btn edit-file-btn" data-id="${file.id}"><i class="fas fa-edit"></i> تعديل</button>
                        <button class="action-btn btn-danger delete-file-btn" data-id="${file.id}"><i class="fas fa-trash-alt"></i> حذف</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // تحديث الإحصائيات
            document.getElementById('totalFiles').textContent = appData.files.length;
        }
        
        // تحديث قائمة الاختبارات في الجدول
        function updateTestsTable() {
            const tableBody = document.getElementById('testsTableBody');
            tableBody.innerHTML = '';
            
            appData.tests.forEach((test, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${test.title}</td>
                    <td>${test.questions} سؤال</td>
                    <td>${test.duration} دقيقة</td>
                    <td>${test.creationDate}</td>
                    <td>${test.users.length} مستخدم</td>
                    <td>
                        <button class="action-btn edit-test-btn" data-id="${test.id}"><i class="fas fa-edit"></i> تعديل</button>
                        <button class="action-btn btn-danger delete-test-btn" data-id="${test.id}"><i class="fas fa-trash-alt"></i> حذف</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // تحديث الإحصائيات
            document.getElementById('totalTests').textContent = appData.tests.length;
        }
        
        // تحديث قائمة ستريك الدخول
        function updateStreakTable() {
            const tableBody = document.getElementById('streakTableBody');
            tableBody.innerHTML = '';
            
            // فرز المستخدمين حسب الستريك
            const sortedUsers = [...appData.users]
                .filter(u => !u.isAdmin)
                .sort((a, b) => b.streak - a.streak);
            
            sortedUsers.forEach((user, index) => {
                const status = calculateRemainingDays(user.subscriptionEnd) > 0 ? 'نشط' : 'منتهي';
                const statusClass = status === 'نشط' ? 'btn-success' : 'btn-danger';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${user.username}</td>
                    <td><span class="action-btn" style="cursor: default; background: rgba(255, 154, 158, 0.2); border-color: rgba(255, 154, 158, 0.3);"><i class="fas fa-fire"></i> ${user.streak}</span></td>
                    <td>${user.lastLogin}</td>
                    <td><span class="action-btn ${statusClass}" style="cursor: default;">${status}</span></td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // تحديث قوائم الاختيار للمستخدمين
        function updateUsersChecklists() {
            const usersChecklist = document.getElementById('usersChecklist');
            const testUsersChecklist = document.getElementById('testUsersChecklist');
            
            usersChecklist.innerHTML = '';
            testUsersChecklist.innerHTML = '';
            
            appData.users.forEach(user => {
                if (user.username === 'admin') return;
                
                const checkbox1 = document.createElement('div');
                checkbox1.style.marginBottom = '8px';
                checkbox1.innerHTML = `
                    <input type="checkbox" id="user-${user.username}-files" name="users" value="${user.username}" checked>
                    <label for="user-${user.username}-files">${user.username}</label>
                `;
                usersChecklist.appendChild(checkbox1);
                
                const checkbox2 = document.createElement('div');
                checkbox2.style.marginBottom = '8px';
                checkbox2.innerHTML = `
                    <input type="checkbox" id="user-${user.username}-tests" name="testUsers" value="${user.username}" checked>
                    <label for="user-${user.username}-tests">${user.username}</label>
                `;
                testUsersChecklist.appendChild(checkbox2);
            });
        }
        
        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            // إنشاء الرسوم المتحركة
            createParticles();
            
            // تحديث الجداول
            updateUsersTable();
            updateFilesTable();
            updateTestsTable();
            updateStreakTable();
            updateUsersChecklists();
            
            // تسجيل الدخول
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // التحقق من بيانات الدخول
                const user = appData.users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    appData.currentUser = user;
                    
                    // تحديث آخر دخول وزيادة الستريك
                    const today = new Date().toISOString().split('T')[0];
                    const lastLoginDate = user.lastLogin;
                    
                    if (today === lastLoginDate) {
                        // تم الدخول اليوم مسبقاً
                    } else {
                        // زيادة الستريك
                        user.streak++;
                        user.lastLogin = today;
                    }
                    
                    // عرض لوحة المسؤول
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    
                    // إظهار رسالة ترحيب
                    alert(`مرحباً ${user.username}! تم تسجيل الدخول بنجاح.`);
                } else {
                    alert('اسم المستخدم أو كلمة المرور غير صحيحة!');
                }
            });
            
            // تسجيل الخروج
            document.getElementById('logoutBtn').addEventListener('click', function() {
                appData.currentUser = null;
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('loginContainer').style.display = 'block';
                document.getElementById('loginForm').reset();
            });
            
            // التنقل بين الأقسام
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // إزالة النشاط من جميع الأزرار
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    // إضافة النشاط للزر الحالي
                    this.classList.add('active');
                    
                    // إخفاء جميع الأقسام
                    document.querySelectorAll('.admin-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // إظهار القسم المحدد
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                });
            });
            
            // إضافة مستخدم جديد
            document.getElementById('addUserForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const newUsername = document.getElementById('newUsername').value;
                const newPassword = document.getElementById('newPassword').value;
                const newEmail = document.getElementById('newEmail').value;
                const subscriptionDays = parseInt(document.getElementById('subscriptionDays').value);
                
                // التحقق من عدم تكرار اسم المستخدم
                if (appData.users.find(u => u.username === newUsername)) {
                    alert('اسم المستخدم موجود مسبقاً!');
                    return;
                }
                
                // حساب تاريخ انتهاء الاشتراك
                const today = new Date();
                const endDate = new Date(today);
                endDate.setDate(today.getDate() + subscriptionDays);
                const endDateStr = endDate.toISOString().split('T')[0];
                const joinDateStr = today.toISOString().split('T')[0];
                
                // إضافة المستخدم الجديد
                appData.users.push({
                    username: newUsername,
                    password: newPassword,
                    email: newEmail,
                    joinDate: joinDateStr,
                    subscriptionEnd: endDateStr,
                    streak: 0,
                    lastLogin: joinDateStr,
                    isAdmin: false
                });
                
                // تحديث الجداول
                updateUsersTable();
                updateUsersChecklists();
                updateStreakTable();
                
                // إعادة تعيين النموذج
                document.getElementById('addUserForm').reset();
                document.getElementById('subscriptionDays').value = 30;
                
                alert(`تم إضافة المستخدم ${newUsername} بنجاح!`);
            });
            
            // تجديد جميع الاشتراكات
            document.getElementById('renewAllBtn').addEventListener('click', function() {
                const daysToAdd = parseInt(prompt('كم يوم تريد إضافته لاشتراكات جميع المستخدمين؟', '30'));
                
                if (daysToAdd && daysToAdd > 0) {
                    appData.users.forEach(user => {
                        if (user.username !== 'admin') {
                            const currentEndDate = new Date(user.subscriptionEnd);
                            currentEndDate.setDate(currentEndDate.getDate() + daysToAdd);
                            user.subscriptionEnd = currentEndDate.toISOString().split('T')[0];
                        }
                    });
                    
                    updateUsersTable();
                    updateStreakTable();
                    alert(`تم تجديد اشتراكات جميع المستخدمين بمقدار ${daysToAdd} يوم!`);
                }
            });
            
            // تفويض حذف وتجديد المستخدمين
            document.addEventListener('click', function(e) {
                // تجديد اشتراك مستخدم
                if (e.target.classList.contains('renew-btn') || e.target.parentElement.classList.contains('renew-btn')) {
                    const btn = e.target.classList.contains('renew-btn') ? e.target : e.target.parentElement;
                    const username = btn.getAttribute('data-username');
                    const daysToAdd = parseInt(prompt(`كم يوم تريد إضافته لاشتراك ${username}؟`, '30'));
                    
                    if (daysToAdd && daysToAdd > 0) {
                        const user = appData.users.find(u => u.username === username);
                        const currentEndDate = new Date(user.subscriptionEnd);
                        currentEndDate.setDate(currentEndDate.getDate() + daysToAdd);
                        user.subscriptionEnd = currentEndDate.toISOString().split('T')[0];
                        
                        updateUsersTable();
                        updateStreakTable();
                        alert(`تم تجديد اشتراك ${username} بمقدار ${daysToAdd} يوم!`);
                    }
                }
                
                // حذف مستخدم
                if (e.target.classList.contains('delete-btn') || e.target.parentElement.classList.contains('delete-btn')) {
                    const btn = e.target.classList.contains('delete-btn') ? e.target : e.target.parentElement;
                    const username = btn.getAttribute('data-username');
                    
                    if (confirm(`هل أنت متأكد من حذف المستخدم ${username}؟`)) {
                        appData.users = appData.users.filter(u => u.username !== username);
                        
                        // تحديث الجداول
                        updateUsersTable();
                        updateUsersChecklists();
                        updateStreakTable();
                        
                        alert(`تم حذف المستخدم ${username} بنجاح!`);
                    }
                }
                
                // حذف ملف
                if (e.target.classList.contains('delete-file-btn') || e.target.parentElement.classList.contains('delete-file-btn')) {
                    const btn = e.target.classList.contains('delete-file-btn') ? e.target : e.target.parentElement;
                    const fileId = parseInt(btn.getAttribute('data-id'));
                    
                    if (confirm('هل أنت متأكد من حذف هذا الملف؟')) {
                        appData.files = appData.files.filter(f => f.id !== fileId);
                        updateFilesTable();
                        alert('تم حذف الملف بنجاح!');
                    }
                }
                
                // حذف اختبار
                if (e.target.classList.contains('delete-test-btn') || e.target.parentElement.classList.contains('delete-test-btn')) {
                    const btn = e.target.classList.contains('delete-test-btn') ? e.target : e.target.parentElement;
                    const testId = parseInt(btn.getAttribute('data-id'));
                    
                    if (confirm('هل أنت متأكد من حذف هذا الاختبار؟')) {
                        appData.tests = appData.tests.filter(t => t.id !== testId);
                        updateTestsTable();
                        alert('تم حذف الاختبار بنجاح!');
                    }
                }
            });
            
            // رفع ملف
            document.getElementById('uploadFileForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fileTitle = document.getElementById('fileTitle').value;
                const fileType = document.getElementById('fileType').value;
                const fileDescription = document.getElementById('fileDescription').value;
                const fileUpload = document.getElementById('fileUpload').files[0];
                
                // الحصول على المستخدمين المحددين
                const selectedUsers = [];
                document.querySelectorAll('#usersChecklist input[name="users"]:checked').forEach(checkbox => {
                    selectedUsers.push(checkbox.value);
                });
                
                if (selectedUsers.length === 0) {
                    alert('يرجى تحديد مستخدم واحد على الأقل!');
                    return;
                }
                
                // إنشاء معرف فريد للملف
                const newId = appData.files.length > 0 ? Math.max(...appData.files.map(f => f.id)) + 1 : 1;
                const today = new Date().toISOString().split('T')[0];
                
                // إضافة الملف الجديد
                appData.files.push({
                    id: newId,
                    title: fileTitle,
                    type: fileType,
                    description: fileDescription,
                    uploadDate: today,
                    users: selectedUsers
                });
                
                // تحديث الجدول
                updateFilesTable();
                
                // إعادة تعيين النموذج
                document.getElementById('uploadFileForm').reset();
                document.getElementById('fileType').value = 'pdf';
                
                // إعادة تحديد جميع المستخدمين
                document.querySelectorAll('#usersChecklist input[name="users"]').forEach(checkbox => {
                    checkbox.checked = true;
                });
                
                alert(`تم رفع الملف "${fileTitle}" بنجاح!`);
            });
            
            // تحديد جميع المستخدمين للملفات
            document.getElementById('selectAllUsers').addEventListener('click', function() {
                const checkboxes = document.querySelectorAll('#usersChecklist input[name="users"]');
                const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                
                checkboxes.forEach(cb => {
                    cb.checked = !allChecked;
                });
                
                this.innerHTML = allChecked ? 
                    '<i class="fas fa-check-square"></i> تحديد الكل' : 
                    '<i class="fas fa-times"></i> إلغاء التحديد';
            });
            
            // تحديد جميع المستخدمين للاختبارات
            document.getElementById('selectAllTestUsers').addEventListener('click', function() {
                const checkboxes = document.querySelectorAll('#testUsersChecklist input[name="testUsers"]');
                const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                
                checkboxes.forEach(cb => {
                    cb.checked = !allChecked;
                });
                
                this.innerHTML = allChecked ? 
                    '<i class="fas fa-check-square"></i> تحديد الكل' : 
                    '<i class="fas fa-times"></i> إلغاء التحديد';
            });
            
            // تغيير طريقة إضافة السؤال
            document.querySelectorAll('input[name="questionType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'image') {
                        document.getElementById('questionImageUpload').style.display = 'block';
                        document.getElementById('questionTextInput').style.display = 'none';
                    } else {
                        document.getElementById('questionImageUpload').style.display = 'none';
                        document.getElementById('questionTextInput').style.display = 'block';
                    }
                });
            });
            
            // إضافة سؤال للاختبار الحالي
            document.getElementById('addTestForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const questionType = document.querySelector('input[name="questionType"]:checked').value;
                const choiceA = document.getElementById('choiceA').value;
                const choiceB = document.getElementById('choiceB').value;
                const choiceC = document.getElementById('choiceC').value;
                const choiceD = document.getElementById('choiceD').value;
                const correctAnswer = document.getElementById('correctAnswer').value;
                
                let questionContent = '';
                if (questionType === 'image') {
                    const file = document.getElementById('questionImage').files[0];
                    if (!file) {
                        alert('يرجى رفع صورة للسؤال!');
                        return;
                    }
                    questionContent = `صورة: ${file.name}`;
                } else {
                    questionContent = document.getElementById('questionText').value;
                    if (!questionContent.trim()) {
                        alert('يرجى كتابة نص السؤال!');
                        return;
                    }
                }
                
                // إضافة السؤال للاختبار الحالي
                appData.currentTestQuestions.push({
                    id: appData.currentTestQuestions.length + 1,
                    type: questionType,
                    content: questionContent,
                    choices: {a: choiceA, b: choiceB, c: choiceC, d: choiceD},
                    correctAnswer: correctAnswer
                });
                
                // إعادة تعيين حقول السؤال
                document.getElementById('choiceA').value = '';
                document.getElementById('choiceB').value = '';
                document.getElementById('choiceC').value = '';
                document.getElementById('choiceD').value = '';
                document.getElementById('questionText').value = '';
                document.getElementById('questionImage').value = '';
                document.getElementById('correctAnswer').value = 'a';
                
                alert(`تم إضافة السؤال رقم ${appData.currentTestQuestions.length} للاختبار الحالي!`);
            });
            
            // إنهاء الاختبار وإنشاؤه
            document.getElementById('finishTestBtn').addEventListener('click', function() {
                if (appData.currentTestQuestions.length === 0) {
                    alert('يرجى إضافة أسئلة أولاً قبل إنهاء الاختبار!');
                    return;
                }
                
                const testTitle = document.getElementById('testTitle').value;
                const testDuration = parseInt(document.getElementById('testDuration').value);
                const testDescription = document.getElementById('testDescription').value;
                
                if (!testTitle.trim()) {
                    alert('يرجى إدخال عنوان للاختبار!');
                    return;
                }
                
                // الحصول على المستخدمين المحددين
                const selectedUsers = [];
                document.querySelectorAll('#testUsersChecklist input[name="testUsers"]:checked').forEach(checkbox => {
                    selectedUsers.push(checkbox.value);
                });
                
                if (selectedUsers.length === 0) {
                    alert('يرجى تحديد مستخدم واحد على الأقل!');
                    return;
                }
                
                // إنشاء معرف فريد للاختبار
                const newId = appData.tests.length > 0 ? Math.max(...appData.tests.map(t => t.id)) + 1 : 1;
                const today = new Date().toISOString().split('T')[0];
                
                // إضافة الاختبار الجديد
                appData.tests.push({
                    id: newId,
                    title: testTitle,
                    description: testDescription,
                    duration: testDuration,
                    questions: appData.currentTestQuestions.length,
                    creationDate: today,
                    users: selectedUsers
                });
                
                // تحديث الجدول
                updateTestsTable();
                
                // إعادة تعيين النموذج ومسح الأسئلة الحالية
                appData.currentTestQuestions = [];
                document.getElementById('addTestForm').reset();
                document.getElementById('testDuration').value = 60;
                document.getElementById('correctAnswer').value = 'a';
                
                // إعادة تحديد جميع المستخدمين
                document.querySelectorAll('#testUsersChecklist input[name="testUsers"]').forEach(checkbox => {
                    checkbox.checked = true;
                });
                
                alert(`تم إنشاء الاختبار "${testTitle}" بنجاح بعدد ${appData.tests[appData.tests.length-1].questions} سؤال!`);
            });
        });
    </script>
</body>
</html>
