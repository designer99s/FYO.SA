<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ù†ØµØ© FYO Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
margin:0;
font-family:'Cairo',sans-serif;
background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);
color:#fff;
min-height:100vh;
padding:30px;
}

.box{
background:rgba(255,255,255,.1);
backdrop-filter:blur(20px);
padding:25px;
border-radius:20px;
max-width:420px;
margin:auto;
box-shadow:0 0 30px rgba(0,0,0,.5);
}

h1,h2,h3{text-align:center}

input,button,select{
width:100%;
padding:12px;
margin-top:10px;
border-radius:12px;
border:none;
}

button{
background:#7c3aed;
color:#fff;
font-size:16px;
cursor:pointer;
}

section{
margin-top:20px;
}

.hidden{display:none}

.card{
background:rgba(255,255,255,.08);
padding:15px;
border-radius:15px;
margin-top:10px;
}
</style>
</head>
<body>

<!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div class="box" id="loginBox">
<h1>Ù…Ù†ØµØ© FYO Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h1>
<input id="user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† -->
<div class="box hidden" id="adminBox">
<h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù†</h2>

<section>
<h3>â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨</h3>
<input id="newUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="newPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<input id="days" type="number" placeholder="Ù…Ø¯Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø§Ù„Ø£ÙŠØ§Ù…">
<button onclick="addStudent()">Ø¥Ø¶Ø§ÙØ©</button>
</section>

<section>
<h3>ğŸ“ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù</h3>
<input id="fileName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù">
<input id="fileUsers" placeholder="Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ† user1,user2">
<button onclick="addFile()">Ø¥Ø¶Ø§ÙØ©</button>
</section>

<section>
<h3>ğŸ“ Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø±</h3>
<input id="qText" placeholder="Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
<input id="qImg" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
<input id="o1" placeholder="Ø§Ø®ØªÙŠØ§Ø± 1">
<input id="o2" placeholder="Ø§Ø®ØªÙŠØ§Ø± 2">
<input id="o3" placeholder="Ø§Ø®ØªÙŠØ§Ø± 3">
<input id="correct" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©">
<input id="testUsers" placeholder="Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙŠÙ†">
<button onclick="addTest()">Ø¥Ø¶Ø§ÙØ©</button>
</section>

<button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ -->
<div class="box hidden" id="studentBox">
<h2 id="welcome"></h2>
<p id="streak"></p>

<section>
<h3>ğŸ“ Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
<div id="files"></div>
</section>

<section>
<h3>ğŸ“ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h3>
<div id="tests"></div>
</section>

<button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</div>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
let users = JSON.parse(localStorage.getItem("users")) || {
  admin:{pass:"admin",role:"admin"}
};

let files = JSON.parse(localStorage.getItem("files")) || [];
let tests = JSON.parse(localStorage.getItem("tests")) || [];
let currentUser = null;

function save(){
localStorage.setItem("users",JSON.stringify(users));
localStorage.setItem("files",JSON.stringify(files));
localStorage.setItem("tests",JSON.stringify(tests));
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function login(){
let u=user.value,p=pass.value;
if(!users[u] || users[u].pass!==p){alert("Ø®Ø·Ø£");return;}
currentUser=u;
if(users[u].role==="admin"){
loginBox.classList.add("hidden");
adminBox.classList.remove("hidden");
}else{
updateStreak(u);
showStudent();
}
}

// Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨
function addStudent(){
users[newUser.value]={
pass:newPass.value,
role:"student",
expire:Date.now()+days.value*86400000,
streak:0,
last:0
};
save();
alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©");
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù
function addFile(){
files.push({
name:fileName.value,
users:fileUsers.value.split(",")
});
save(); alert("ØªÙ…");
}

// Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø±
function addTest(){
tests.push({
text:qText.value,
img:qImg.value,
opts:[o1.value,o2.value,o3.value],
correct:correct.value,
users:testUsers.value.split(",")
});
save(); alert("ØªÙ…");
}

// Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨
function showStudent(){
loginBox.classList.add("hidden");
studentBox.classList.remove("hidden");
welcome.innerText="Ù…Ø±Ø­Ø¨Ø§Ù‹ "+currentUser;

streak.innerText="ğŸ”¥ Ø§Ù„Ø³ØªØ±ÙŠÙƒ: "+users[currentUser].streak;

filesDiv();
testsDiv();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª
function filesDiv(){
files.innerHTML="";
files.filter(f=>f.users.includes(currentUser))
.forEach(f=>{
files.innerHTML+=`<div class="card">${f.name}</div>`;
});
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
function testsDiv(){
testsBox=tests;
testsDivEl=document.getElementById("tests");
testsDivEl.innerHTML="";
tests.filter(t=>t.users.includes(currentUser))
.forEach(t=>{
testsDivEl.innerHTML+=`
<div class="card">
${t.img?`<img src="${t.img}" width="100%">`:""}
<p>${t.text}</p>
</div>`;
});
}

// Ø§Ù„Ø³ØªØ±ÙŠÙƒ
function updateStreak(u){
let now=new Date().toDateString();
if(users[u].last!==now){
users[u].streak=(users[u].streak||0)+1;
users[u].last=now;
save();
}
}

// ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
function logout(){
location.reload();
}
</script>

</body>
</html>
